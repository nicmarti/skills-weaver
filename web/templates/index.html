<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{.Title}} - SkillsWeaver</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Crimson+Text:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/fantasy.css">
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
</head>
<body>
<div class="container">
    <header class="header">
        <h1 class="title">SkillsWeaver</h1>
        <p class="subtitle">Moteur de Jeu de Role D&D 5e</p>
    </header>

    <main class="main-content">
        <section class="adventures-section">
            <div class="section-header">
                <h2>Aventures</h2>
                <button class="btn btn-primary" onclick="toggleCreateForm()">
                    + Nouvelle Aventure
                </button>
            </div>

            <div id="create-form" class="create-form hidden">
                <form action="/adventures" method="POST" class="adventure-form">
                    <div class="form-group">
                        <label for="name">Nom de l'aventure</label>
                        <input type="text" id="name" name="name" required
                               placeholder="Ex: La Crypte des Ombres">
                    </div>
                    <div class="form-group">
                        <label for="description">Description</label>
                        <textarea id="description" name="description" rows="3"
                                  placeholder="Une breve description de votre aventure..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="duration">Duree de l'aventure</label>
                        <select id="duration" name="duration" class="form-select">
                            <option value="oneshot">One-shot (1-2 sessions) - 1 acte</option>
                            <option value="short" selected>Courte aventure (3-5 sessions) - 1 acte</option>
                            <option value="campaign">Campagne (8-12 sessions) - 2-3 actes</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="adventure_type">Type d'aventure</label>
                        <select id="adventure_type" name="adventure_type" class="form-select">
                            <option value="">Choix libre</option>
                            <option value="escort">Mission d'escorte</option>
                            <option value="fetch_quest">Quete d'objet</option>
                            <option value="mystery">Enquete / mystere</option>
                            <option value="rescue">Mission de sauvetage</option>
                            <option value="exploration">Exploration / donjon</option>
                            <option value="defense">Garde / defense</option>
                            <option value="heist">Braquage / infiltration</option>
                            <option value="hunt">Chasse au monstre</option>
                            <option value="diplomacy">Diplomatie</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="theme">Theme de campagne (optionnel)</label>
                        <textarea id="theme" name="theme" rows="3"
                                  placeholder="Ex: Escorter un marchand de Cordova a Fer-de-Lance a travers les cols montagneux..."></textarea>
                        <small class="form-hint">Si un type est choisi, le theme precise les details specifiques de votre aventure</small>
                    </div>
                    <div class="form-note">
                        <strong>Note :</strong> Si des personnages existent dans <code>data/characters/</code>, ils seront automatiquement ajoutes a cette aventure.
                        Sinon, vous pourrez creer de nouveaux personnages via <code>sw-character</code>.
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="toggleCreateForm()">
                            Annuler
                        </button>
                        <button type="submit" class="btn btn-primary">
                            Creer
                        </button>
                    </div>
                </form>
            </div>

            <div id="adventures-list" class="adventures-grid">
                {{if .Adventures}}
                    {{range .Adventures}}
                    <div class="adventure-card-wrapper">
                        <a href="/play/{{.Slug}}" class="adventure-card">
                            <div class="card-header">
                                <h3>{{.Name}}</h3>
                                <span class="status status-{{.Status}}">{{.Status}}</span>
                            </div>
                            <p class="card-description">{{.Description}}</p>
                            <div class="card-footer">
                                <span class="sessions">{{.SessionCount}} sessions</span>
                                <span class="last-played">Derniere session: {{.LastPlayed.Format "02/01/2006"}}</span>
                            </div>
                        </a>
                        <div class="card-actions">
                            <form action="/adventures/{{.Slug}}/archive" method="POST" style="display:inline">
                                <button type="submit" class="btn btn-small btn-secondary" title="Archiver">Archiver</button>
                            </form>
                        </div>
                    </div>
                    {{end}}
                {{else}}
                    <div class="empty-state">
                        <div class="empty-icon">&#x1F3B2;</div>
                        <p>Aucune aventure pour le moment</p>
                        <p class="hint">Creez votre premiere aventure pour commencer</p>
                    </div>
                {{end}}
            </div>
        </section>
    </main>

    <footer class="footer">
        <p>SkillsWeaver - Propulse par Claude</p>
    </footer>
</div>

<script>
function toggleCreateForm() {
    const form = document.getElementById('create-form');
    form.classList.toggle('hidden');
    if (!form.classList.contains('hidden')) {
        document.getElementById('name').focus();
    }
}
</script>
</body>
</html>
