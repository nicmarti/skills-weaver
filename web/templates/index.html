<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{.Title}} - SkillsWeaver</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Crimson+Text:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/fantasy.css">
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
</head>
<body>
<div class="container">
    <header class="header">
        <h1 class="title">SkillsWeaver</h1>
        <p class="subtitle">Moteur de Jeu de Role D&D 5e</p>
    </header>

    <main class="main-content">
        <section class="adventures-section">
            <div class="section-header">
                <h2>Aventures</h2>
                <button class="btn btn-primary" onclick="toggleCreateForm()">
                    + Nouvelle Aventure
                </button>
            </div>

            <div id="create-form" class="create-form hidden">
                <form action="/adventures" method="POST" class="adventure-form">
                    <div class="form-group">
                        <label for="name">Nom de l'aventure</label>
                        <input type="text" id="name" name="name" required
                               placeholder="Ex: La Crypte des Ombres">
                    </div>
                    <div class="form-group">
                        <label for="description">Description</label>
                        <textarea id="description" name="description" rows="3"
                                  placeholder="Une breve description de votre aventure..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="theme">Theme de campagne (optionnel)</label>
                        <textarea id="theme" name="theme" rows="3"
                                  placeholder="Ex: Conspiration maritime avec entite ancienne scellee sous une cite perdue..."></textarea>
                        <small class="form-hint">Si fourni, le DM generera automatiquement un plan narratif structure en 3 actes</small>
                    </div>
                    <div class="form-note">
                        <strong>Note :</strong> Si des personnages existent dans <code>data/characters/</code>, ils seront automatiquement ajoutes a cette aventure.
                        Sinon, vous pourrez creer de nouveaux personnages via <code>sw-character</code>.
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="toggleCreateForm()">
                            Annuler
                        </button>
                        <button type="submit" class="btn btn-primary">
                            Creer
                        </button>
                    </div>
                </form>
            </div>

            <div id="adventures-list" class="adventures-grid">
                {{if .Adventures}}
                    {{range .Adventures}}
                    <a href="/play/{{.Slug}}" class="adventure-card">
                        <div class="card-header">
                            <h3>{{.Name}}</h3>
                            <span class="status status-{{.Status}}">{{.Status}}</span>
                        </div>
                        <p class="card-description">{{.Description}}</p>
                        <div class="card-footer">
                            <span class="sessions">{{.SessionCount}} sessions</span>
                            <span class="last-played">Derniere session: {{.LastPlayed.Format "02/01/2006"}}</span>
                        </div>
                    </a>
                    {{end}}
                {{else}}
                    <div class="empty-state">
                        <div class="empty-icon">&#x1F3B2;</div>
                        <p>Aucune aventure pour le moment</p>
                        <p class="hint">Creez votre premiere aventure pour commencer</p>
                    </div>
                {{end}}
            </div>
        </section>
    </main>

    <footer class="footer">
        <p>SkillsWeaver - Propulse par Claude</p>
    </footer>
</div>

<script>
function toggleCreateForm() {
    const form = document.getElementById('create-form');
    form.classList.toggle('hidden');
    if (!form.classList.contains('hidden')) {
        document.getElementById('name').focus();
    }
}
</script>
</body>
</html>
